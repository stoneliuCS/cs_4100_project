"""
Crime dataset creation
"""

import io
from pathlib import Path
import pandas as pd
import requests

CSV_PATH = Path(__file__).parent / "crime.csv"
CRIMES = [
    "Other Larceny",
    "Fraud",
    "Auto Theft",
    "Investigate Person",
    "Simple Assault",
    "MV Crash Response",
    "Investigate Property",
    "Firearm Violations",
    "Vandalism",
    "Missing Person Reported",
    "Verbal Disputes",
    "Service",
    "Violations",
    "Landlord/Tenant Disputes",
    "Property Found",
    "Drug Violation",
    "Criminal Harassment",
    "Harbor Related Incidents",
    "Missing Person Located",
    "Medical Assistance",
    "Towed",
    "Other",
    "License Violation",
    "Restraining Order Violations",
    "Prisoner Related Incidents",
    "Robbery",
    "Fire Related Reports",
    "Search Warrants",
    "Property Lost",
    "Rape & Attempted",
    "Indecent Assault",
    "Offenses Against Child / Family",
    "Aggravated Assault",
    "Operating Under the Influence",
    "Warrant Arrests",
    "Sex Offender Registration",
    "Larceny from MV",
    "Liquor Violation",
    "Residential Burglary",
    "Evading Fare",
    "Confidence Games",
    "Commercial Burglary",
    "Ballistics",
    "Prostitution",
    "Death Investigation",
    "Disorderly Conduct",
    "Firearm Discovery",
    "Police Service Incidents",
    "Recovered Stolen Property",
    "License Plate Related Incidents",
    "Aircraft",
    "Assembly or Gathering Violations",
    "Property Related Damage",
    "Counterfeiting",
    "Embezzlement",
    "Auto Theft Recovery",
    "Arson",
    "Homicide",
    "Bomb Hoax",
    "Explosives",
    "Phone Call Complaints",
    "Human Trafficking",
    "MISSING PERSON",
    "FIRE REPORT",
    "TOWED",
    "SIMPLE ASSAULT",
    "MEDICAL ASSISTANCE",
    "MV CRASH RESPONSE",
    "OTHER LARCENY",
    "INVESTIGATE PERSON",
    "FIRE RELATED REPORTS",
    "INVESTIGATE PROPERTY",
    "PROPERTY FOUND",
    "PROPERTY LOST",
    "LARCENY FROM MV",
    "OTHER",
    "WARRANT ARRESTS",
    "SEARCH WARRANTS",
    "MISSING PERSON LOCATED",
    "VERBAL DISPUTES",
    "AGGRAVATED ASSAULT",
    "VANDALISM",
    "DRUG VIOLATION",
    "RESIDENTIAL BURGLARY",
    "OFFENSES AGAINST CHILD / FAMILY",
    "AUTO THEFT",
    "POLICE SERVICE INCIDENTS",
    "FRAUD",
    "VIOLATIONS",
    "COUNTERFEITING",
    "CRIMINAL HARASSMENT",
    "ROBBERY",
    "CONFIDENCE GAMES",
    "RESTRAINING ORDER VIOLATIONS",
    "MISSING PERSON REPORTED",
    "LICENSE VIOLATION",
    "DEATH INVESTIGATION",
    "HOMICIDE",
    "RAPE & ATTEMPTED",
    "COMMERCIAL BURGLARY",
    "INDECENT ASSAULT",
    "FIREARM VIOLATIONS",
    "RECOVERED STOLEN PROPERTY",
    "SERVICE",
    "BALLISTICS",
    "FIREARM DISCOVERY",
    "OPERATING UNDER THE INFLUENCE",
    "LANDLORD/TENANT DISPUTES",
    "LICENSE PLATE RELATED INCIDENTS",
    "PROPERTY RELATED DAMAGE",
    "AUTO THEFT RECOVERY",
    "DISORDERLY CONDUCT",
    "EMBEZZLEMENT",
    "LIQUOR VIOLATION",
    "SEX OFFENDER REGISTRATION",
    "PROSTITUTION",
    "HARBOR RELATED INCIDENTS",
    "EVADING FARE",
    "ARSON",
    "PRISONER RELATED INCIDENTS",
    "ASSEMBLY OR GATHERING VIOLATIONS",
    "PROPERTY - ACCIDENTAL DAMAGE",
    "BOMB HOAX",
    "AIRCRAFT",
    "DRUGS - POSSESSION/ SALE/ MANUFACTURING/ USE",
    "ASSAULT - SIMPLE",
    "M/V ACCIDENT - PERSONAL INJURY",
    "VERBAL DISPUTE",
    "LARCENY THEFT FROM BUILDING",
    "FRAUD - CREDIT CARD / ATM FRAUD",
    "THREATS TO DO BODILY HARM",
    "LARCENY ALL OTHERS",
    "LARCENY SHOPLIFTING",
    "SERVICE TO OTHER AGENCY",
    "M/V - LEAVING SCENE - PROPERTY DAMAGE",
    "HARASSMENT/ CRIMINAL HARASSMENT",
    "LARCENY THEFT OF BICYCLE",
    "FRAUD - FALSE PRETENSE / SCHEME",
    "LARCENY THEFT FROM MV - NON-ACCESSORY",
    "M/V ACCIDENT - OTHER",
    "SICK/INJURED/MEDICAL - PERSON",
    "FORGERY / COUNTERFEITING",
    "SICK ASSIST",
    "VIOLATION - RESTRAINING ORDER (NO ARREST)",
    "M/V ACCIDENT - INVOLVING PEDESTRIAN - INJURY",
    "VAL - VIOLATION OF AUTO LAW",
    "M/V ACCIDENT - INVOLVING BICYCLE - INJURY",
    "TOWED MOTOR VEHICLE",
    "BALLISTICS EVIDENCE/FOUND",
    "PROPERTY - LOST/ MISSING",
    "LARCENY THEFT OF MV PARTS & ACCESSORIES",
    "MISSING PERSON - LOCATED",
    "PROPERTY - FOUND",
    "M/V ACCIDENT - PROPERTY DAMAGE",
    "ASSAULT - AGGRAVATED",
    "FIRE REPORT/ALARM - FALSE",
    "WARRANT ARREST - BOSTON WARRANT (MUST BE SUPPLEMEN",
    "PROPERTY - LOST THEN LOCATED",
    "OBSCENE MATERIALS - PORNOGRAPHY",
    "BURGLARY - COMMERICAL",
    "TRESPASSING",
    "CHILD ENDANGERMENT",
    "M/V ACCIDENT - OTHER CITY VEHICLE",
    "M/V ACCIDENT - POLICE VEHICLE",
    "VIOLATION - CITY ORDINANCE",
    "SICK/INJURED/MEDICAL - POLICE",
    "MISSING PERSON - NOT REPORTED - LOCATED",
    "SEX OFFENSE - OTHER",
    "FRAUD - WIRE",
    "TRUANCY / RUNAWAY",
    "DANGEROUS OR HAZARDOUS CONDITION",
    "M/V - LEAVING SCENE - PERSONAL INJURY",
    "SUDDEN DEATH",
    "M/V ACCIDENT - INVOLVING BICYCLE - NO INJURY",
    "WARRANT ARREST - OUTSIDE OF BOSTON WARRANT",
    "SICK ASSIST - DRUG RELATED ILLNESS",
    "INDECENT EXPOSURE/ LEWD AND LASCIVIOUS/ OPEN AND G",
    "LICENSE PREMISE VIOLATION",
    "VAL - OPERATING W/O AUTHORIZATION LAWFUL",
    "FAILURE TO REGISTER AS A SEX OFFENDER",
    "RECOVERED - MV RECOVERED IN BOSTON (STOLEN OUTSIDE",
    "OPERATING UNDER THE INFLUENCE (OUI) ALCOHOL",
    "IDENTITY FRAUD c266.37E",
    "DISTURBING THE PEACE/ DISORDERLY CONDUCT/ GATHERIN",
    "AUTO THEFT - MOTORCYCLE / SCOOTER",
    "VIOL. OF RESTRAINING ORDER W ARREST",
    "Fondling - Indecent Assault",
    "HARBOR INCIDENT / VIOLATION",
    "LANDLORD - TENANT",
    "MURDER, NON-NEGLIGENT MANSLAUGHTER",
    "POSSESSION OF BURGLARIOUS TOOLS",
    "OTHER OFFENSE",
    "SEARCH WARRANT",
    "FRAUD - WELFARE",
    "M/V PLATES - LOST",
    "SEXUAL ASSAULT INVESTIGATION",
    "ANIMAL INCIDENTS (DOG BITES, LOST DOG, ETC)",
    "STOLEN PROPERTY - BUYING / RECEIVING / POSSESSING",
    "WEAPON VIOLATION - CARRY/ POSSESSING/ SALE/ TRAFFI",
    "VIOLATION - HARASSMENT PREVENTION ORDER",
    "RECOVERED - MV RECOVERED IN BOSTON (STOLEN IN BOST",
    "LIQUOR LAW VIOLATION",
    "FIREARM/WEAPON - FOUND OR CONFISCATED",
    "LARCENY PURSE SNATCH - NO FORCE",
    "DRUGS - POSSESSION OF DRUG PARAPHANALIA",
    "VAL - OPERATING AFTER REV/SUSP.",
    "ANIMAL ABUSE",
    "BOMB THREAT",
    "NOISY PARTY/RADIO-NO ARREST",
    "M/V ACCIDENT - INVOLVING PEDESTRIAN - NO INJURY",
    "SEX OFFENSE - RAPE - FORCIBLE",
    "SEXUAL ASSAULT KIT COLLECTED",
    "SEX OFFENSE - RAPE - SODOMY",
    "BREAKING AND ENTERING (B&E) MOTOR VEHICLE (NO PROP",
    "FUGITIVE FROM JUSTICE",
    "HUMAN TRAFFICKING",
    "MANSLAUGHTER",
    "PHONE CALL COMPLAINTS",
    "EXPLOSIVES",
    "BIOLOGICAL THREAT",
    "GAMBLING",
]


def build_crime_scores():
    crime_severity = {
        # Severity 5 - Most Heinous (Homicide, Serious Violence, Sexual Assault)
        "Homicide": 5,
        "HOMICIDE": 5,
        "MURDER, NON-NEGLIGENT MANSLAUGHTER": 5,
        "MANSLAUGHTER": 5,
        "Rape & Attempted": 5,
        "RAPE & ATTEMPTED": 5,
        "SEX OFFENSE - RAPE - FORCIBLE": 5,
        "SEX OFFENSE - RAPE - SODOMY": 5,
        "HUMAN TRAFFICKING": 5,
        "Human Trafficking": 5,
        "Arson": 5,
        "ARSON": 5,
        # Severity 4 - Serious Violent Crimes
        "Aggravated Assault": 4,
        "AGGRAVATED ASSAULT": 4,
        "ASSAULT - AGGRAVATED": 4,
        "Robbery": 4,
        "ROBBERY": 4,
        "Indecent Assault": 4,
        "INDECENT ASSAULT": 4,
        "Fondling - Indecent Assault": 4,
        "INDECENT EXPOSURE/ LEWD AND LASCIVIOUS/ OPEN AND G": 4,
        "Firearm Violations": 4,
        "FIREARM VIOLATIONS": 4,
        "WEAPON VIOLATION - CARRY/ POSSESSING/ SALE/ TRAFFI": 4,
        "Offenses Against Child / Family": 4,
        "OFFENSES AGAINST CHILD / FAMILY": 4,
        "CHILD ENDANGERMENT": 4,
        "SEXUAL ASSAULT INVESTIGATION": 4,
        "SEXUAL ASSAULT KIT COLLECTED": 4,
        "SEX OFFENSE - OTHER": 4,
        "Explosives": 4,
        "EXPLOSIVES": 4,
        "Bomb Hoax": 4,
        "BOMB HOAX": 4,
        "BOMB THREAT": 4,
        "BIOLOGICAL THREAT": 4,
        "ANIMAL ABUSE": 4,
        "FUGITIVE FROM JUSTICE": 4,
        # Severity 3 - Property Crimes, Burglary, Theft, Drug Violations
        "Residential Burglary": 3,
        "RESIDENTIAL BURGLARY": 3,
        "Commercial Burglary": 3,
        "COMMERCIAL BURGLARY": 3,
        "BURGLARY - COMMERICAL": 3,
        "Auto Theft": 3,
        "AUTO THEFT": 3,
        "AUTO THEFT - MOTORCYCLE / SCOOTER": 3,
        "BREAKING AND ENTERING (B&E) MOTOR VEHICLE (NO PROP": 3,
        "Larceny from MV": 3,
        "LARCENY FROM MV": 3,
        "LARCENY THEFT FROM MV - NON-ACCESSORY": 3,
        "LARCENY THEFT OF MV PARTS & ACCESSORIES": 3,
        "Other Larceny": 3,
        "OTHER LARCENY": 3,
        "LARCENY ALL OTHERS": 3,
        "LARCENY THEFT FROM BUILDING": 3,
        "LARCENY SHOPLIFTING": 3,
        "LARCENY THEFT OF BICYCLE": 3,
        "LARCENY PURSE SNATCH - NO FORCE": 3,
        "Fraud": 3,
        "FRAUD": 3,
        "FRAUD - CREDIT CARD / ATM FRAUD": 3,
        "FRAUD - FALSE PRETENSE / SCHEME": 3,
        "FRAUD - WIRE": 3,
        "FRAUD - WELFARE": 3,
        "IDENTITY FRAUD c266.37E": 3,
        "Confidence Games": 3,
        "CONFIDENCE GAMES": 3,
        "Counterfeiting": 3,
        "COUNTERFEITING": 3,
        "FORGERY / COUNTERFEITING": 3,
        "Embezzlement": 3,
        "EMBEZZLEMENT": 3,
        "Drug Violation": 3,
        "DRUG VIOLATION": 3,
        "DRUGS - POSSESSION/ SALE/ MANUFACTURING/ USE": 3,
        "DRUGS - POSSESSION OF DRUG PARAPHANALIA": 3,
        "Criminal Harassment": 3,
        "CRIMINAL HARASSMENT": 3,
        "HARASSMENT/ CRIMINAL HARASSMENT": 3,
        "THREATS TO DO BODILY HARM": 3,
        "Death Investigation": 3,
        "DEATH INVESTIGATION": 3,
        "SUDDEN DEATH": 3,
        "Restraining Order Violations": 3,
        "RESTRAINING ORDER VIOLATIONS": 3,
        "VIOLATION - RESTRAINING ORDER (NO ARREST)": 3,
        "VIOL. OF RESTRAINING ORDER W ARREST": 3,
        "VIOLATION - HARASSMENT PREVENTION ORDER": 3,
        "Operating Under the Influence": 3,
        "OPERATING UNDER THE INFLUENCE": 3,
        "OPERATING UNDER THE INFLUENCE (OUI) ALCOHOL": 3,
        "Prostitution": 3,
        "PROSTITUTION": 3,
        "OBSCENE MATERIALS - PORNOGRAPHY": 3,
        "STOLEN PROPERTY - BUYING / RECEIVING / POSSESSING": 3,
        "RECOVERED STOLEN PROPERTY": 3,
        "Recovered Stolen Property": 3,
        "POSSESSION OF BURGLARIOUS TOOLS": 3,
        "Ballistics": 3,
        "BALLISTICS": 3,
        "BALLISTICS EVIDENCE/FOUND": 3,
        "Firearm Discovery": 3,
        "FIREARM DISCOVERY": 3,
        "FIREARM/WEAPON - FOUND OR CONFISCATED": 3,
        "GAMBLING": 3,
        # Severity 2 - Less Serious Crimes, Assaults, Vehicle Incidents
        "Simple Assault": 2,
        "SIMPLE ASSAULT": 2,
        "ASSAULT - SIMPLE": 2,
        "Vandalism": 2,
        "VANDALISM": 2,
        "Property Related Damage": 2,
        "PROPERTY RELATED DAMAGE": 2,
        "PROPERTY - ACCIDENTAL DAMAGE": 2,
        "Warrant Arrests": 2,
        "WARRANT ARRESTS": 2,
        "WARRANT ARREST - BOSTON WARRANT (MUST BE SUPPLEMEN": 2,
        "WARRANT ARREST - OUTSIDE OF BOSTON WARRANT": 2,
        "Auto Theft Recovery": 2,
        "AUTO THEFT RECOVERY": 2,
        "RECOVERED - MV RECOVERED IN BOSTON (STOLEN OUTSIDE": 2,
        "RECOVERED - MV RECOVERED IN BOSTON (STOLEN IN BOST": 2,
        "Disorderly Conduct": 2,
        "DISORDERLY CONDUCT": 2,
        "DISTURBING THE PEACE/ DISORDERLY CONDUCT/ GATHERIN": 2,
        "Liquor Violation": 2,
        "LIQUOR VIOLATION": 2,
        "LIQUOR LAW VIOLATION": 2,
        "License Violation": 2,
        "LICENSE VIOLATION": 2,
        "LICENSE PREMISE VIOLATION": 2,
        "Sex Offender Registration": 2,
        "SEX OFFENDER REGISTRATION": 2,
        "FAILURE TO REGISTER AS A SEX OFFENDER": 2,
        "Evading Fare": 2,
        "EVADING FARE": 2,
        "Towed": 2,
        "TOWED": 2,
        "TOWED MOTOR VEHICLE": 2,
        "MV Crash Response": 2,
        "MV CRASH RESPONSE": 2,
        "M/V ACCIDENT - PERSONAL INJURY": 2,
        "M/V ACCIDENT - INVOLVING PEDESTRIAN - INJURY": 2,
        "M/V ACCIDENT - INVOLVING BICYCLE - INJURY": 2,
        "M/V ACCIDENT - INVOLVING BICYCLE - NO INJURY": 2,
        "M/V ACCIDENT - INVOLVING PEDESTRIAN - NO INJURY": 2,
        "M/V ACCIDENT - OTHER": 2,
        "M/V ACCIDENT - PROPERTY DAMAGE": 2,
        "M/V ACCIDENT - OTHER CITY VEHICLE": 2,
        "M/V ACCIDENT - POLICE VEHICLE": 2,
        "M/V - LEAVING SCENE - PROPERTY DAMAGE": 2,
        "M/V - LEAVING SCENE - PERSONAL INJURY": 2,
        "VAL - VIOLATION OF AUTO LAW": 2,
        "VAL - OPERATING W/O AUTHORIZATION LAWFUL": 2,
        "VAL - OPERATING AFTER REV/SUSP.": 2,
        "TRESPASSING": 2,
        "TRUANCY / RUNAWAY": 2,
        "NOISY PARTY/RADIO-NO ARREST": 2,
        "ASSEMBLY OR GATHERING VIOLATIONS": 2,
        "Assembly or Gathering Violations": 2,
        # Severity 1 - Minor Incidents, Administrative, Service Calls
        "Investigate Person": 1,
        "INVESTIGATE PERSON": 1,
        "Investigate Property": 1,
        "INVESTIGATE PROPERTY": 1,
        "Missing Person Reported": 1,
        "MISSING PERSON REPORTED": 1,
        "MISSING PERSON": 1,
        "Missing Person Located": 1,
        "MISSING PERSON LOCATED": 1,
        "MISSING PERSON - LOCATED": 1,
        "MISSING PERSON - NOT REPORTED - LOCATED": 1,
        "Verbal Disputes": 1,
        "VERBAL DISPUTES": 1,
        "VERBAL DISPUTE": 1,
        "Service": 1,
        "SERVICE": 1,
        "SERVICE TO OTHER AGENCY": 1,
        "Violations": 1,
        "VIOLATIONS": 1,
        "VIOLATION - CITY ORDINANCE": 1,
        "Landlord/Tenant Disputes": 1,
        "LANDLORD/TENANT DISPUTES": 1,
        "LANDLORD - TENANT": 1,
        "Property Found": 1,
        "PROPERTY FOUND": 1,
        "PROPERTY - FOUND": 1,
        "Property Lost": 1,
        "PROPERTY LOST": 1,
        "PROPERTY - LOST/ MISSING": 1,
        "PROPERTY - LOST THEN LOCATED": 1,
        "Medical Assistance": 1,
        "MEDICAL ASSISTANCE": 1,
        "SICK/INJURED/MEDICAL - PERSON": 1,
        "SICK/INJURED/MEDICAL - POLICE": 1,
        "SICK ASSIST": 1,
        "SICK ASSIST - DRUG RELATED ILLNESS": 1,
        "Other": 1,
        "OTHER": 1,
        "OTHER OFFENSE": 1,
        "Harbor Related Incidents": 1,
        "HARBOR RELATED INCIDENTS": 1,
        "HARBOR INCIDENT / VIOLATION": 1,
        "Prisoner Related Incidents": 1,
        "PRISONER RELATED INCIDENTS": 1,
        "Fire Related Reports": 1,
        "FIRE RELATED REPORTS": 1,
        "FIRE REPORT": 1,
        "FIRE REPORT/ALARM - FALSE": 1,
        "Search Warrants": 1,
        "SEARCH WARRANTS": 1,
        "SEARCH WARRANT": 1,
        "Police Service Incidents": 1,
        "POLICE SERVICE INCIDENTS": 1,
        "License Plate Related Incidents": 1,
        "LICENSE PLATE RELATED INCIDENTS": 1,
        "M/V PLATES - LOST": 1,
        "Aircraft": 1,
        "AIRCRAFT": 1,
        "Phone Call Complaints": 1,
        "PHONE CALL COMPLAINTS": 1,
        "ANIMAL INCIDENTS (DOG BITES, LOST DOG, ETC)": 1,
        "DANGEROUS OR HAZARDOUS CONDITION": 1,
    }
    assert set(crime_severity.keys()) == set(CRIMES)
    return crime_severity


def assign_crime_scores(row):
    """
    Assigns a crime score to the following row
    """
    crime: str = row["Crime"]
    crime_scores = build_crime_scores()
    crime_score = crime_scores[crime]
    return crime_score


def batch_geo_encoding_crimes(aggregated_crimes: pd.DataFrame) -> pd.DataFrame:
    # Transform the aggregated_crimes to be in the format of the geo_encoding API
    transformed_df = aggregated_crimes[["Block Address", "City", "Zip Code"]]
    transformed_df["state"] = "MA"
    transformed_df = transformed_df.rename(
        columns={"Block Address": "address", "City": "city", "Zip Code": "zip"}
    )
    transformed_df["address"] = transformed_df["address"].str.replace(
        r"\d+ BLOCK ", "50 ", regex=True
    )

    def batch_csv(transformed_df: pd.DataFrame) -> list[Path]:
        row_limit = 9999
        num_rows = len(transformed_df)
        csv_paths = []
        for i in range(0, num_rows, row_limit):
            start_row = i
            end_row = min(i + row_limit, num_rows)
            chunk_df = transformed_df.iloc[start_row:end_row]
            output_csv_file = Path(__file__).parent / Path(
                f"output_chunk_{i // row_limit + 1}.csv"
            )
            chunk_df.to_csv(output_csv_file)
            csv_paths.append(output_csv_file)
        return csv_paths

    def single_csv_batch_req(csv_path: Path) -> pd.DataFrame:
        files = {
            "addressFile": (
                str(csv_path),
                open(csv_path, "rb"),
                "text/csv",
            )
        }
        params = {"benchmark": "Public_AR_Current"}
        URL = "https://geocoding.geo.census.gov/geocoder/locations/addressbatch"
        r = requests.post(URL, files=files, params=params)
        if r.status_code == 200:
            df = pd.read_csv(io.StringIO(r.content.decode()))
            return df
        else:
            raise RuntimeError("Error:", r.status_code, r.text)

    csv_paths = batch_csv(transformed_df)
    geocoded_df = None
    for csv_path in csv_paths:
        batch_geocoded_df = single_csv_batch_req(csv_path)
        if geocoded_df is None:
            geocoded_df = batch_geocoded_df
        else:
            geocoded_df = pd.concat([geocoded_df, batch_geocoded_df], axis=0)
    return geocoded_df


def main():
    if not CSV_PATH.exists():
        raise RuntimeError(
            f"{CSV_PATH} not found, please download it here: https://boston-pd-crime-hub-boston.hub.arcgis.com/datasets/d42bd4040bca419a824ae5062488aced/explore"
        )
    crime_dataframe = pd.read_csv(CSV_PATH)
    select_columns = [
        "Crime",
        "Offense Code",
        "Offense Description",
        "Block Address",
        "City",
        "Zip Code",
        "Premise Description",
        "Weapon Description",
        "Crime Part",
        "Crime Category",
        "Report Date",
        "Hour of Day",
        "Neighborhood",
    ]
    crime_dataframe: pd.DataFrame = crime_dataframe[select_columns]
    crime_dataframe["Crime Score"] = crime_dataframe.apply(assign_crime_scores, axis=1)
    aggregated_crimes = (
        crime_dataframe.groupby(
            [
                "Block Address",
                "City",
                "Zip Code",
                "Neighborhood",
                "Hour of Day",
                "Crime",
                "Crime Category",
            ]
        )["Crime Score"]
        .sum()
        .reset_index()
    )
    geo_coded_crime_df = batch_geo_encoding_crimes(aggregated_crimes)


if __name__ == "__main__":
    main()
